# Конфигурация приложения

Путь к основному конфигурационному файлу приложения задается в константе **KIRA_MAIN_CONFIG**. Сам файл конфигурации - php-скрипт, возвращающий ассоциативный массив.

**В именах ключей нельзя использовать точку**. Почему - рассказано документе *"Доступ к конфигурации"*.

Пример конфига:

```PHP
$main = [
    'indexHandler' => 'app\controllers\MainController->welcome',

    'router' => [
        '404_handler'   => 'app\controllers\ErrorController',
        'routes'        => require 'routes.php',
    ],

    'db' => [
        // прим.: строка подключения, юзер и пароль задаются в env.php
        'options' => [
            PDO::ATTR_TIMEOUT => 10,
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
        ],
    ],

    'domain' => 'site.com',

    'admin_mail'   => 'admin@site.com',
    'noreply_mail' => 'noreply@site.com',

    'timezone' => 'Asia/Novosibirsk',
];

$env = require 'env.php'; // конфиг среды окружения (== конфиг конкретного сервера)

return kira\utils\Arrays::mergeRecursive($main, $env, true);

```

Движку требуется несколько обязательных настроек (параметров). Так же существует несколько рекомендуемых параметров.

***indexHandler***  - **обязательная настройка**. Контроллер приложения по умолчанию. Полностью определённое имя класса (FQN), от корневого пространства имен. Так же нужно указать метод, если он отличается от дефолтного. См. пример выше.

***router*** - **обязательная настройка**. Подробнее см. док *"Роутинг > Конфигурация"*.

***db*** - условно-обязательная настройка. Требуется, только если приложение работает с базами данных через PDO, используя при этом функционал движка. Проще говоря, движок здесь ищет строку подключения и ключи к БД. Подробнее в доке "*DB*"

***log*** - необязательная настройка логера. Без нее логер будет работать с настройками по умолчанию, см. док *"Логер"*

***domain*** - необязательно. Если `Env::domain()` не найдет имя домена в $_SERVER['HTTP_HOST'], попытается прочитать его в этой настройке. На имя домена завязаны некоторые другие функции класса `\kira\web\Env`, см. док *"Среда окружения сайта"*.

***admin_mail*** - ящик админа, условно-обязательная настройка. Как минимум, логер шлет сообщения на мыло админу.

***noreply_mail*** - необязательная настройка. Адрес отправителя для автоматических писателей, типа логера.

***timezone*** - необязательная настройка. Часовой пояс сайта для PHP функций даты/времени. Значение должно быть строкой, понятной PHP, полный список поясов [здесь](http://php.net/manual/en/timezones.php). Если не задана, считается UTC.

*Прим: До PHP 7.0 нужно было явно задавать часовой пояс, если используются функции даты/времени. Это можно было сделать через вызов [date_default_timezone_set()](http://php.net/manual/en/function.date-default-timezone-set.php) или задать пояс в php.ini. В 7й версии требование стало необязательным, по умолчанию считается UTC.*

### Часовые пояса и конфигурация приложения

В полном конфиге приложения вы встретите три(!) настройки часовых поясов:

- *timezone* - основной пояс сайта, как сказано выше.
- *log.php_timezone* - пояс для записей лога. Он может отличаться от времени сайта, подробнее в доке *"Логер"*.
- *db.mysql_timezone* - пояс MySQL-сессии. Подробнее в доке *"DB"*
