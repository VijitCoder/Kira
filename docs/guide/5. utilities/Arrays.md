# Утилиты. Arrays

Класс `\kira\utils\Arrays`

Работа с массивами. В это трудно поверить, но при всем богатстве php-методов все еще есть, что свое написать :) В частности, методы работы с многомерными массивами через рекурсию или извлечение конечного значения по многомерному ключу массива.

В PHP есть [SPL с итераторами](http://php.net/manual/ru/spl.iterators.php). Но как показывает практика, например, [тут](http://php.net/manual/ru/class.recursiveiteratoriterator.php#112713), рекурсивные функции быстрее. Хотя конечно для всех итераторов я тесты не видел.

---

Получение значения из массива по заданной цепочке ключей

function __getValue(array &$arr, $chain)__: _mixed_

В чем смысл. Допустим, есть некий многомерный массив:

```php
$data = [
    'path' => [
        'app' => [
            'level1' => '/home',
            'level2' => '/www',
        ],
    ],
 ...
];
```

Нужно получить значение из `level2`. В обычной ситуации это будет:

```php
$v = $data['path']['app']['level2'];
```

Но когда мы не можем напрямую описать ключи, используем эту функцию:

```php
/**
 * Получение сообщения для конкретного поля формы
 * @param array $messages многомерный массив сообщений по полям формы
 * @param array $key      многомерный массив ключей, указывающий на конкретное поле
 */
function getMessage($messages, $key)
{
    return Arrays::getValue($messages, $key);
}
```

---

Стабильная сортировка массива через callback-функцию.

function __stableSort(array &$array, callable $comparisionFunction)__: _void_

Все PHP `*sort()` функции нестабильны. Они могут перемешать результ, если в массиве больше 16 элементов И если
некоторые из них равны. Эта проблема известна годами, но до сих пор присутствует в PHP 7.1. Официально в мануле сказано:

> Если оба сравниваемых значения эквивалентны, то порядок их в отсортированном массиве не определен.

На практике это означает, что равные элементы могут быть переставлены между собой, что не есть гуд. С точки зрениясортировки ошибки нет, т.к. функция сказала, что элементы равны, значит из положение относительно друг друга не имеет значения. Но с клиентской стороны иногда нужно, чтобы исходное положение равных элементов все же не поменялось. Для этого служит метод `stableSort()`.
