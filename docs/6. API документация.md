# Генерация API документации движка

Для генерации используются комментарии в классах и методах движка.

Генератор - [apigen](https://github.com/ApiGen/ApiGen).

Конфиг [kira/docs/conf/apigen_vendor.neon].

Вызов:

```
# генерация для исходного проекта движка
vendor/bin/apigen generate --config ./docs/conf/apigen.neon

# генерация в составе вендорных библиотек приложения
vendor/bin/apigen generate --config ./vendor/vijitcoder/kira/docs/conf/apigen_vendor.neon
```

*Можно добавить ключ `-o, --overwrite` для автоматической перезаписи документации.*

Первый вариант подходит для генерации в проекте, где сам движок и есть - проект. Т.е. это для меня (Vijit), как разработчика движка. Второй вызов для генерации документации в конечном приложении. При этом в приложении должна быть добавлена зависимость:

```sh
composer require apigen/apigen
```

Замысел такой: в конечном приложении используется Kira. Ставим doc-генератор, собираем документацию, делаем симлинк куда-то подближе на каталог [vendor/vijitcoder/kira/docs/], пользуемся. Конечно, когда-нибудь возможно я запущу отдельный сайт для этого творения. Но пока только так.

Кстати, тут есть одна маленькая проблема: после `composer update` сгенерированная ранее документация исчезнет.. М-да, засада :) Решается добавлением в конфиг composer.json вашего приложения такой вот части:

```json
 "scripts": {
    "post-update-cmd":[
        "vendor/bin/apigen generate --config ./vendor/vijitcoder/kira/docs/conf/apigen_vendor.neon -o"
    ]
 }
```

Конечно, я мог бы прописать это в конфиге движка. Но вдруг кому-то эта документация будет по-боку, зачем ему лишняя генерация.

## Баги

На данный момент я нашел у `apigen` следующие баги:

- `@method`, описание метода с двумя параметрами не попадает в документацию. Пример, `net/Request`, методы типа `getAsRegexp(string $key, string $pattern)`.
- `@see`, не парсятся ссылки. Зато если указать `class::method`, ссылка получается, но никуда не ведет.
