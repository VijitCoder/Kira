**НОВОЕ СВЕРХУ**
   
### v 2.1 /20 февраля 2021/

_Я бы не спешил с обновлением, но новый composer заставил это сделать._

- Переименовал методы snake_case -> camelCase в классах-утилитах. Это изменение несовместимо с предыдущей версией движка.
- Переделал подход к дефолтным значениям формы.
- Исправил баги в валидаторах Enum и Password.
- Вернул валидатор даты
- Обновил документацию и вендорные библиотеки

##### v 2.0.1 минорное обновление `normalize_string`

Новые фичи:

- Валидатор `normalize_string` может вырезать теги вместо их преобразования. Так же можно передать в валидатор флаги для функции `php::htmlspecialchars()`, которая используется в общей схеме дезинфекции строки.

Исправления:

- валидатор `normalize_string` неверно работал с юникодом.

### v 2.0 /5 сентября 2018/

**Изменения, несовместимые с версией 1.x:**

- Поднял минимальную версию PHP до 7.1.
- Изменилась структура таблицы логера.
- Пересмотрел роль класса `Response` в движке. Появились методы работы с заголовками, объект класса `Response` доступен через свойство контроллера.
- Основательно переработал механизм валидации. В частности:
    - Заменил валидаторы `bounds` и `length` на общий валидатор `limits`.
    - Валидаторы `email`, `password` и `normalize_string` переехали из утилит.
    - Валидатор `date` упразднен, его больше нет в движке. Он был в `\kira\utils\Validators::date()`.
    - Переписал валидатор `external`.
    - Больше нет поддержки двойных имен валидаторов, состоящих из нескольких слов. Все названия в snake_case.
    - CSRF защита теперь часть механизма валидации. Была в `Request`.
- Изменения поддержки БД:
    - Упростил использование `DBModel::valueSet()`. Теперь на вход подаем ассоциативный массив в одном параметре. Было два параметра - массив с ключами и массив с данными.
    - DbModel: убрал поле `$table` и неуклюжий метод `findByField()`.
    - Только один тип исключения из слоя БД - `DbException`. Разница в кодах исключения.

Новые фичи:

- Суперкласс `kira\core\DTO` - реализация шаблона проектирования *Value object (объект-значение)*.
- Абстрактный класс `kira\utils\Enum` - альтернативная реализация `php::SplEnum`.
- Пошаговая загрузка конфигурации, см. док *"Использование конфигурации"*.
- Новые методы контроллера `renderExternal()` и `widget()`. Поддержка виджетов экспериментальная, возможно будет удалена в будущих версиях.
- Новый валидатор `typecast` - приведение значения к заданному типу через модель формы.
- Новый валидатор `enum` - проверка значения по списку допустимых значений.
- Модель формы. Добавил поддержку дефолтных значений в контракте.
- Несколько новых методов в `kira\db\DbModel`.
- Несколько новых методов в `kira\net\Request` и `kira\net\Session`.
- Стек перехваченных исключений. Полезная штука, когда перехват исключения в клиентском коде заворачивает его в новое исключение и кидает дальше уже свое.
- Трейт для замены `php::glob()` в vfsStream в тестах.

Обновления утилит:

- `Strings::strBool()` - приведение булева значения к строке.
- `Strings::br2nl()` -преобразование html-тега \<br> в перенос строки, принятый в текущей ОС.
- `Strings::randomString()` - генерация псевдослучайной строки из читабельных символов.
- `FS::isWindowsRootedPath()` - проверка, что переданный каталог похож на абсолютный в стиле Windows.
- `FS::getMyDirectory()` - получение абсолютного пути к скрипту класса по его объекту.
- `FS::pathInfo()` - более адекватный аналог `php::pathinfo()` и `php::SplFileInfo`.
- `Arrays::isAssociative()` - рекурсивная проверка массива на ассоциативность.
- `Arrays::stableSort()` - стабильная сортировка массива через callback-функцию.
- Новый класс утилит `System` - собрание системных функций в классовой обертке.
- Новый класс утилит `Typecast` - строгое приведение типов.
- Новый класс утилит `StringCase` - преобразование строки между различными регистрами: CamelCase, snake_case, kebab-case. Нет мультибайтной поддержки, работает только с латиницей.

Изменения, исправления:

- `FS::normalizePath()` - нормализация пути теперь убирает ведущий слеш.
- fix: метод `DbModel::fetchValue()` неправильно трактовал NULL, как результат.
- DbModel `prepareIN()`, `simulate()`. Подготовка IN-условия неправильно заменяла подстановки, если ключи без ведущего двоеточия. Симуляция запросов с IN-подстановками вообще падала.
- Реорганизация документации. Теперь найти нужный док должно быть проще.

... и много других улучшений и исправлений.

###  v 1.5 /16 марта 2017/

Новые фичи:

- перехватчики исключений и ошибок различают ситуации обращения к сайту: console, ajax или обычный http-запрос. Вывод ошибок будет в разном стиле, согласно типа запроса.
- CallAsPublic - трейт для тестирования непубличных методов
- в Convisor добавлена поддержка именованных параметров (задаются через один/два минуса) и подкаталогов со скриптами

Обновления утилит:

- новая утилита **ColorConsole**. Вывод в консоль можно раскрасить.
- Arrays::buildTree() - построение иерахического дерева в массиве
- Arrays::value_extract() - извлечение элемента по заданному ключу
- FS: normalizePath() - нормализация пути: обратные слеши переводятся в прямые, в конце дописывается слеш
- FS:dirList() - получение списка файлов в указанном каталоге
- Strings::isShielded() - проверка экранированности символа

Изменения, исправления:

- **добавил преффикс KIRA_ ко всем константам движка**
- DbModel. Переименовал fetchField() -> fetchValue(); добавил метод fetchColumn()
- стиль результатов SQL запросов теперь реально работает с учетом настройки БД
- несколько исправлений и улучшений роутера
- рефакторинг комментариев и документации движка
- переход на Sami генератор API документации
- улучшил Response. Можно точнее управлять кодами и видом ответов. Но теперь для этого нужно создавать объект класса Response

###  v 1.4 /25 октября 2016/

Новые фичи:

- генератор документации API
- экземпляр класса загрузчика Composer можно получить в приложении, см. App::composer()
- добавлен метод модели для получения значения одного поля из одного ряда запроса
- простенький менеджер консоли Convisor
- реализован шаблон проектирования Registry (Реестр)

Изменения, исправления:

- сменилось пространство имен движка engine > kira
- сменилось имя класса Log > Logger
- мелкие поправки в переход на PHP 7
- поправки роутера: получение URL-ов, стыковка с загрузчиком Composer
- теперь движок бросает свои исключения
- исключение при ошибках в БД бросаем при любом состоянии KIRA_DEBUG
- улучшен вывод исключений и ошибок в консоль
- добавлена поддержка через трейт шаблона проектирования Singleton (Одиночка)
- unit-тесты всех утилит
- интеграционные тесты модели форм и роутера

###  v 1.3 /5 октября 2016/

Новые фичи:

- **поддержка Composer**
- защита от CSRF-атаки
- логирование редиректов роутера

Изменения:

- убрал методы-действия до и после отрисовки частичного шаблона `renderPartial()`. При основной отрисовке методы остались.
- вынес часовой пояс сайта в настройки
- мелкие изменения и поправки

###  v 1.2 /27 июня 2016/

Новые фичи:

- **мастер создания приложения**
- логер
- простой почтовый класс (mailer)
- свои обработчики PHP-ошибок
- класс Request для суперглобальных массивов
- утилита по работе с файловой системой

Изменения:

- новая версия модели формы
- упрощенная работа с пространством имен приложения
- реорганизация каталогов статики
- новые методы в классе utils/Arrays
- небольшой рефакторинг БД модели

###  v 1.1 /январь 2016/

Очень много изменений. Довожу проект до состояния более-менее движка.

Обновления:

- перешел на использование пространств имен
- появилась документация
- серьезный роутер
- утилиты
- и т.д. и т.п.


### v 1.0 /20 сентября 2015/

первая версия проекта, созданная для выполнения тестовой задачи "зона юзера".
